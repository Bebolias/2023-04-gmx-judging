Ch_301

false

# [05-27 19:08] [no impact]

## Summary
In case this [block](https://github.com/sherlock-audit/2023-04-gmx/blob/main/gmx-synthetics/contracts/position/DecreasePositionCollateralUtils.sol#L79-L87) didn't get executed because of the `values.priceImpactDiffUsd =< 0` and the order type isn't `LiquidationOrder`.
```solidity
        collateralCache.adjustedPositionPnlUsd = values.positionPnlUsd;
        collateralCache.adjustedPriceImpactDiffUsd = values.priceImpactDiffUsd;

        if (values.positionPnlUsd > 0 && values.priceImpactDiffUsd > 0) {
            if (values.positionPnlUsd > values.priceImpactDiffUsd.toInt256()) {
                collateralCache.adjustedPositionPnlUsd = values.positionPnlUsd - values.priceImpactDiffUsd.toInt256();
                collateralCache.adjustedPriceImpactDiffUsd = 0;
            } else {
                collateralCache.adjustedPositionPnlUsd = 0;
                collateralCache.adjustedPriceImpactDiffUsd = values.priceImpactDiffUsd - values.positionPnlUsd.toUint256();
            }
        }
```
so `adjustedPositionPnlUsd ` and `values.positionPnlUsd` are still the same `collateralCache.adjustedPositionPnlUsd == values.positionPnlUsd`

going forward to this [block](https://github.com/sherlock-audit/2023-04-gmx/blob/main/gmx-synthetics/contracts/position/DecreasePositionCollateralUtils.sol#L119-L137)
```solidity
        } else {
            // position realizes a profit
            // deduct the pnl from the pool
            values.pnlTokenForPool = cache.pnlToken;
            values.pnlAmountForPool = -values.positionPnlUsd / cache.pnlTokenPrice.max.toInt256();
            values.pnlAmountForUser = collateralCache.adjustedPositionPnlUsd.toUint256() / cache.pnlTokenPrice.max;

            // if the price impact was capped send the difference to a holding area
            collateralCache.pnlDiffAmount = (-values.pnlAmountForPool - values.pnlAmountForUser.toInt256()).toUint256();
            if (collateralCache.pnlDiffAmount > 0) {
                MarketUtils.incrementClaimableCollateralAmount(
                    params.contracts.dataStore,
                    params.contracts.eventEmitter,
                    params.market.marketToken,
                    cache.pnlToken,
                    params.order.receiver(),
                    collateralCache.pnlDiffAmount
                );
            }
```
We can notes `values.pnlAmountForPool` and `values.pnlAmountForUser` will get the same value with different signs (plus and minus)
Now this computation 
```solidity
collateralCache.pnlDiffAmount = (-values.pnlAmountForPool - values.pnlAmountForUser.toInt256()).toUint256();
```
will result zero.

to summarize:
- `values.pnlAmountForPool` = -X
- `values.pnlAmountForUser` = X
- `collateralCache.pnlDiffAmount` = 0 

## Vulnerability Detail

## Impact

## Code Snippet

## Tool used

Manual Review

## Recommendation
