VictoryGod

medium

# Arbitrary `from` in transferFrom [Router.sol]

## Summary
The smart contract Router contains a vulnerability related to an arbitrary `from` parameter in the `transferFrom` function. The vulnerability allows an attacker to transfer tokens from another user's account by calling the `pluginTransfer` function with a manipulated from parameter. Although the contract uses the `safeTransferFrom` function from the `SafeERC20` library, additional measures are required to mitigate this vulnerability.
## Vulnerability Detail
The vulnerability in the provided code is not related to the `SafeERC20` library. `SafeERC20` is a helper library for interacting with external `ERC20` tokens safely, rather than making your token itself safe.

The vulnerability arises from the `pluginTransfer` function's `account` parameter, which can be set to any address as the from parameter in the `transferFrom` function call. This allows potential attackers to transfer tokens from another user's account without proper authorization.

## Impact
Exploiting the vulnerability allows attackers to transfer tokens from another user's account without their consent. By manipulating the from parameter in the `transferFrom` function, an attacker can initiate unauthorized token transfers.

## Code Snippet
https://github.com/sherlock-audit/2023-04-gmx/blob/main/gmx-synthetics/contracts/router/Router.sol#L26


## Tool used

Manual Review

## Recommendation
- Implement a mechanism to check the `allowance` of tokens. Before initiating the transfer, ensure that the caller has `approved` the contract to spend the specified amount of tokens. This can be achieved by adding an `approve` step or checking the `allowance` of tokens. Implementing this step will ensure that the transfer is authorized and prevents unauthorized transfers.
- Use `msg.sender` as the from parameter in the `transferFrom` function to ensure that the transfer is initiated by the authorized account.

It's Good to be careful about this.