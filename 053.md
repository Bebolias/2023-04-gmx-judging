chaduke

medium

# OracleUtils#validateSigner() is subject to signature replay attack.

## Summary
``OracleUtils#validateSigner()`` is subject to signature replay attack. The main problem is that it fails to comply with EIP-712 (https://eips.ethereum.org/EIPS/eip-712). For example, ``chainId`` is not signed in the signature. Therefore, signature replay attack is possible for example across chain. 

## Vulnerability Detail
``OracleUtils#validateSigner()`` allows one to verify a signature of the price information signed by an oracle: 


[https://github.com/sherlock-audit/2023-04-gmx/blob/main/gmx-synthetics/contracts/oracle/OracleUtils.sol#L230C24-L255](https://github.com/sherlock-audit/2023-04-gmx/blob/main/gmx-synthetics/contracts/oracle/OracleUtils.sol#L230C24-L255)

However, when calculating the hash, it does not comply with EIP-712. For example, there is no domain separator and the ``chainId`` is not signed. Therefore, signature replay attack is possible for example across chain. 


## Impact
``OracleUtils#validateSigner()`` is subject to signature replay attack. The main problem is that it fails to comply with EIP-712 (https://eips.ethereum.org/EIPS/eip-712). For example, ``chainId`` is not signed in the signature. Therefore, signature replay attack is possible for example across chain. 

## Code Snippet

## Tool used
Remix

Manual Review

## Recommendation
Study the EIP-712 and include a domain separator, in particular ``chainId`` to avoid signature replay. 
